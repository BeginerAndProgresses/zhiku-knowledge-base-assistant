# 本地向量数据库存储方案

## 方案对比

### 1. Chroma (推荐)
- **优点**: 
  - 轻量级，易于设置和使用
  - 专为向量搜索优化
  - 支持本地持久化
  - 与LangChain集成良好
- **缺点**:
  - 不适用于大规模数据集 (>1M 向量)
  - 无内置并发控制
- **适用场景**: 个人知识库、原型开发、中小型数据集

### 2. FAISS (Facebook AI Similarity Search)
- **优点**:
  - 高效的相似性搜索
  - 内存占用低
  - 支持GPU加速
- **缺点**:
  - 设置相对复杂
  - 需要手动管理存储
- **适用场景**: 大规模向量搜索、生产环境

### 3. Weaviate
- **优点**:
  - 功能强大，支持混合搜索
  - GraphQL API
  - 自动模式推断
- **缺点**:
  - 需要运行独立服务
  - 资源消耗较高
- **适用场景**: 复杂知识图谱、企业级应用

### 4. Pinecone (非本地，云服务)
- **优点**:
  - 完全托管
  - 自动缩放
  - 优秀的性能
- **缺点**:
  - 非本地，数据隐私问题
  - 需要网络连接
  - 付费服务
- **适用场景**: 云原生应用

## 推荐配置: Chroma

我们选择了Chroma作为默认的本地向量数据库，因为它符合项目需求：

- 完全本地化，保障数据隐私
- 易于设置和维护
- 与LangChain框架高度兼容
- 适合中小型知识库

### 存储结构

```
项目根目录/
├── db_storage/           # Chroma数据库持久化目录
│   ├── index_metadata.json
│   ├── index.pkl
│   └── ...
├── tools/
│   ├── ingestion.py      # 文档导入功能
│   └── query_db.py       # 数据库查询功能
```

### 性能优化建议

1. **嵌入模型**: 使用高效的中文嵌入模型如 `BAAI/bge-large-zh-v1.5`
2. **文本分割**: 根据文档类型调整块大小和重叠
3. **索引策略**: 定期清理和优化向量索引
4. **批处理**: 大量文档导入时使用批处理提高效率

### 数据备份

定期备份 `./db_storage` 目录以防止数据丢失:

```bash
cp -r ./db_storage/ ./backup/db_storage_backup_$(date +%Y%m%d)/
```

### 扩展性考虑

- 如需支持更大规模的数据，可考虑迁移到FAISS
- 如需更多功能（如访问控制），可考虑Weaviate
- 如需网络访问，可考虑将Chroma包装在API服务中